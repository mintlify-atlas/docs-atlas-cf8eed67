---
title: "Vim Plugin Usage"
description: "Master fzf in Vim with custom commands, key bindings, and advanced configurations"
---

The fzf Vim plugin provides powerful functions for building custom fuzzy finders. Learn how to use `fzf#run()`, `fzf#wrap()`, and the `:FZF` command to create your own commands.

## The :FZF Command

The `:FZF` command is a basic fuzzy file selector that demonstrates the plugin's capabilities:

```vim
" Look for files under current directory
:FZF

" Look for files under your home directory
:FZF ~

" With fzf command-line options
:FZF --reverse --info=inline /tmp

" Bang version starts fzf in fullscreen mode
:FZF!
```

### Key Bindings

By default, you can open selected files in different ways:

- `Enter` - Open in current window
- `CTRL-T` - Open in new tab
- `CTRL-X` - Open in horizontal split
- `CTRL-V` - Open in vertical split

<Note>
The environment variables `FZF_DEFAULT_COMMAND` and `FZF_DEFAULT_OPTS` also apply here.
</Note>

## Configuration Options

Customize fzf behavior with global variables:

### g:fzf_action

Customize key bindings for opening selected files:

```vim
" This is the default extra key bindings
let g:fzf_action = {
  \ 'ctrl-t': 'tab split',
  \ 'ctrl-x': 'split',
  \ 'ctrl-v': 'vsplit' }
```

You can also use function references for custom actions:

```vim
" An action can be a reference to a function that processes selected lines
function! s:build_quickfix_list(lines)
  call setqflist(map(copy(a:lines), '{ "filename": v:val, "lnum": 1 }'))
  copen
  cc
endfunction

let g:fzf_action = {
  \ 'ctrl-q': function('s:build_quickfix_list'),
  \ 'ctrl-t': 'tab split',
  \ 'ctrl-x': 'split',
  \ 'ctrl-v': 'vsplit' }
```

### g:fzf_layout

Determine the size and position of the fzf window:

<Tabs>
  <Tab title="Popup Window">
    ```vim
    " Popup window (center of the screen)
    let g:fzf_layout = { 'window': { 'width': 0.9, 'height': 0.6 } }
    
    " Popup window (center of the current window)
    let g:fzf_layout = { 'window': { 'width': 0.9, 'height': 0.6, 'relative': v:true } }
    
    " Popup window (anchored to the bottom of the current window)
    let g:fzf_layout = { 'window': { 'width': 0.9, 'height': 0.6, 'relative': v:true, 'yoffset': 1.0 } }
    ```
  </Tab>
  <Tab title="Split Windows">
    ```vim
    " Down / up / left / right
    let g:fzf_layout = { 'down': '40%' }
    let g:fzf_layout = { 'up': '40%' }
    let g:fzf_layout = { 'left': '40%' }
    let g:fzf_layout = { 'right': '40%' }
    ```
  </Tab>
  <Tab title="Vim Commands">
    ```vim
    " Window using a Vim command
    let g:fzf_layout = { 'window': 'enew' }
    let g:fzf_layout = { 'window': '-tabnew' }
    let g:fzf_layout = { 'window': '10new' }
    ```
  </Tab>
  <Tab title="tmux Popup">
    ```vim
    " tmux popup window (requires tmux 3.2+)
    if exists('$TMUX')
      let g:fzf_layout = { 'tmux': '90%,70%' }
    else
      let g:fzf_layout = { 'window': { 'width': 0.9, 'height': 0.6 } }
    endif
    ```
  </Tab>
</Tabs>

<Tip>
Popup windows require Vim 8.2+ or Neovim 0.4+. Available border styles: `rounded`, `sharp`, `horizontal`, `vertical`, `top`, `bottom`, `left`, `right`, `no[ne]`.
</Tip>

### g:fzf_colors

Customize fzf colors to match your color scheme:

```vim
" Customize fzf colors to match your color scheme
" - fzf#wrap translates this to a set of `--color` options
let g:fzf_colors =
\ { 'fg':      ['fg', 'Normal'],
  \ 'bg':      ['bg', 'Normal'],
  \ 'hl':      ['fg', 'Comment'],
  \ 'fg+':     ['fg', 'CursorLine', 'CursorColumn', 'Normal'],
  \ 'bg+':     ['bg', 'CursorLine', 'CursorColumn'],
  \ 'hl+':     ['fg', 'Statement'],
  \ 'info':    ['fg', 'PreProc'],
  \ 'border':  ['fg', 'Ignore'],
  \ 'prompt':  ['fg', 'Conditional'],
  \ 'pointer': ['fg', 'Exception'],
  \ 'marker':  ['fg', 'Keyword'],
  \ 'spinner': ['fg', 'Label'],
  \ 'header':  ['fg', 'Comment'] }
```

The format is: `element: [component, group1, group2, ...]`

- `element` - fzf element to colorize (fg, bg, hl, border, etc.)
- `component` - `fg` or `bg` attribute to extract
- `group1, group2, ...` - Highlight groups searched in order

<Note>
You can examine the generated color options by running `:echo fzf#wrap()`
</Note>

### g:fzf_history_dir

Enable per-command history:

```vim
" Enable per-command history
" - History files will be stored in the specified directory
" - When set, CTRL-N and CTRL-P will be bound to 'next-history' and
"   'previous-history' instead of 'down' and 'up'.
let g:fzf_history_dir = '~/.local/share/fzf-history'
```

## Using fzf#run()

The `fzf#run()` function is the core of the Vim integration. It takes a spec dictionary and starts fzf accordingly:

```vim
" Open files with default file source
call fzf#run({'sink': 'e'})

" Open in new tab
call fzf#run({'sink': 'tabedit'})

" Use git ls-files as source
call fzf#run({'source': 'git ls-files', 'sink': 'e'})

" Add fzf options
call fzf#run({'sink': 'tabedit', 'options': '--multi --reverse'})

" Specify layout
call fzf#run({'source': 'git ls-files', 'sink': 'e', 'left': '40%'})
```

### Spec Options

Available options for the spec dictionary:

| Option | Type | Description |
|--------|------|-------------|
| `source` | string | External command to generate input (e.g. `find .`) |
| `source` | list | Vim list as input to fzf |
| `sink` | string | Vim command to handle the selected item (e.g. `e`, `tabe`) |
| `sink` | funcref | Function to be called with each selected item |
| `sinklist` (or `sink*`) | funcref | Takes the list of output lines at once |
| `exit` | funcref | Function called with fzf's exit status |
| `options` | string/list | Options to fzf |
| `dir` | string | Working directory |
| `up`/`down`/`left`/`right` | number/string | Window position and size (e.g. `20`, `50%`) |
| `tmux` | string | `--tmux` options (e.g. `90%,70%`) |
| `window` | string | Command to open fzf window (e.g. `vertical aboveleft 30new`) |
| `window` | dict | Popup window settings (e.g. `{'width': 0.9, 'height': 0.6}`) |

<Warning>
For `options`, prefer list format over string to avoid escaping issues:
```vim
" Good: List format
call fzf#run({'options': ['--reverse', '--prompt', 'C:\\Program Files\\']})

" Avoid: String format with escaping
call fzf#run({'options': '--reverse --prompt "C:\\\\Program Files\\\\"'})
```
</Warning>

### Advanced Examples

#### Color Scheme Selector

```vim
" Color scheme selector using Vim array as source
call fzf#run({'source': map(split(globpath(&rtp, 'colors/*.vim')),
            \               'fnamemodify(v:val, ":t:r")'),
            \ 'sink': 'colo', 'left': '25%'})
```

#### Function Sink

```vim
" Use a function to process the selection
function! s:open_in_split(file)
  execute 'split' a:file
endfunction

call fzf#run({'source': 'find .', 'sink': function('s:open_in_split')})
```

## Using fzf#wrap()

The `fzf#wrap()` function wraps your spec with global preferences:

```vim
" Basic usage
call fzf#run(fzf#wrap({'source': 'ls'}))

" Now supports CTRL-T, CTRL-V, CTRL-X from g:fzf_action
" and respects g:fzf_layout setting
```

### Creating Custom Commands

Build a custom `:LS` command that respects global settings:

<Steps>
  <Step title="Basic command">
    ```vim
    command! LS call fzf#run(fzf#wrap({'source': 'ls'}))
    ```
  </Step>
  
  <Step title="Add fullscreen support">
    ```vim
    " On :LS!, <bang> evaluates to '!', and '!0' becomes 1
    command! -bang LS call fzf#run(fzf#wrap({'source': 'ls'}, <bang>0))
    ```
  </Step>
  
  <Step title="Add directory argument">
    ```vim
    command! -bang -complete=dir -nargs=? LS
        \ call fzf#run(fzf#wrap({'source': 'ls', 'dir': <q-args>}, <bang>0))
    ```
  </Step>
  
  <Step title="Add history support">
    ```vim
    " History will be stored as 'ls' inside g:fzf_history_dir
    command! -bang -complete=dir -nargs=? LS
        \ call fzf#run(fzf#wrap('ls', {'source': 'ls', 'dir': <q-args>}, <bang>0))
    ```
  </Step>
</Steps>

### Signature

```vim
fzf#wrap([name string], [spec dict], [fullscreen bool]) -> (dict)
```

- `name` - For managing history files (ignored if `g:fzf_history_dir` not set)
- `spec` - Your spec dictionary
- `fullscreen` - `0` or `1` (default: `0`)

### Global Options Supported

- `g:fzf_layout` - Always applied
- `g:fzf_action` - Applied only when no custom `sink` is provided
- `g:fzf_colors` - Always applied
- `g:fzf_history_dir` - Always applied

<Note>
`g:fzf_action` only works when you don't provide a custom sink, since custom sinks typically handle non-file data (like color schemes) where the tab/split actions don't make sense.
</Note>

## Advanced Tips

### Hide Statusline

When fzf starts in a terminal buffer, you can customize the window settings:

```vim
let g:fzf_layout = { 'down': '30%' }
autocmd! FileType fzf
autocmd  FileType fzf set laststatus=0 noshowmode noruler
  \| autocmd BufLeave <buffer> set laststatus=2 showmode ruler
```

### Popup Window Options

When `window` is a dictionary, these options are available:

**Required:**
- `width` - Float [0-1] or integer [8+]
- `height` - Float [0-1] or integer [4+]

**Optional:**
- `xoffset` - Float, default 0.5 [0-1]
- `yoffset` - Float, default 0.5 [0-1]
- `relative` - Boolean, default `v:false`
- `border` - String, default `rounded` (`sharp` on Windows)
  - Options: `rounded`, `sharp`, `horizontal`, `vertical`, `top`, `bottom`, `left`, `right`, `no[ne]`

```vim
let g:fzf_layout = { 'window': { 'width': 0.9, 'height': 0.6 } }
```

## Complete Example

Here's a complete configuration example:

```vim
" Installation (using vim-plug)
Plug 'junegunn/fzf', { 'do': { -> fzf#install() } }
Plug 'junegunn/fzf.vim'

" Layout: popup window
let g:fzf_layout = { 'window': { 'width': 0.9, 'height': 0.6 } }

" Customize colors
let g:fzf_colors =
\ { 'fg':      ['fg', 'Normal'],
  \ 'bg':      ['bg', 'Normal'],
  \ 'hl':      ['fg', 'Comment'],
  \ 'fg+':     ['fg', 'CursorLine', 'CursorColumn', 'Normal'],
  \ 'bg+':     ['bg', 'CursorLine', 'CursorColumn'],
  \ 'hl+':     ['fg', 'Statement'],
  \ 'info':    ['fg', 'PreProc'],
  \ 'border':  ['fg', 'Ignore'],
  \ 'prompt':  ['fg', 'Conditional'],
  \ 'pointer': ['fg', 'Exception'],
  \ 'marker':  ['fg', 'Keyword'],
  \ 'spinner': ['fg', 'Label'],
  \ 'header':  ['fg', 'Comment'] }

" Enable history
let g:fzf_history_dir = '~/.local/share/fzf-history'

" Custom commands
command! -bang -nargs=? -complete=dir Files
    \ call fzf#run(fzf#wrap('files', {
    \   'source': 'fd --type f --hidden --follow --exclude .git',
    \   'dir': <q-args>
    \ }, <bang>0))

command! -bang Colors
    \ call fzf#run(fzf#wrap('colors', {
    \   'source': map(split(globpath(&rtp, 'colors/*.vim')),
    \                 'fnamemodify(v:val, ":t:r")'),
    \   'sink': 'colo'
    \ }, <bang>0))
```

<Tip>
For more pre-built commands like `:Files`, `:Buffers`, `:Rg`, and `:Commits`, check out the [fzf.vim](https://github.com/junegunn/fzf.vim) project.
</Tip>